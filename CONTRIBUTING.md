# Contributing

## Prerequisites

Whether you want to contribute to the codebase or just to the documentation, there are a few things you should have before getting started:

- [git](https://git-scm.com/), [GitHub Desktop](https://desktop.github.com/), [GitKraken](https://www.gitkraken.com/git-client) or any other Git client
- [rustup](https://rustup.rs/)
- some editor: [Visual Studio Code](https://code.visualstudio.com/)

## Updating the documentation with mdBook

The documentation is written in Markdown, and we use [mdBook](https://rust-lang.github.io/mdBook/) to create a static site. The source is located in the [docs](./docs) folder.

You can install mdBook using `cargo`:

```bash
cargo install mdBook
```

The `serve` command can be used to generate a preview of the documentation and view it locally in the browser:

```bash
mdbook serve ./docs --open -p 9999
```

## Contributing to the Codebase

This project is almost exclusively written in Rust so here are some editors and plugins you should use to make your life easier:

- Free: [Visual Studio Code](https://code.visualstudio.com/) + [rust-analyzer](https://github.com/rust-lang/rust-analyzer) extension
- Paid: [CLion](https://www.jetbrains.com/clion/) + [Rust](https://plugins.jetbrains.com/plugin/8182-rust/docs) extension

If you have CLion, you can use the pre-configured Run Configurations in [.run/](./.run).

To get started, you first need the **nightly** toolchain to compile the code:

```bash
rustup toolchain install nightly
```

You should also install and use [clippy](https://github.com/rust-lang/rust-clippy) and [rustfmt](https://github.com/rust-lang/rustfmt):

```bash
rustup component add clippy rustfmt
```

If you add or change any dependencies you should run [cargo-deny](https://github.com/EmbarkStudios/cargo-deny) and make sure there are no issues:

```bash
cargo install cargo-deny
cargo deny check
```

### Compiler Explorer

The website located in [compiler-explorer](./compiler-explorer) uses the [WASM](./wasm) bindings generated by `wasm-bindgen`. You will need the WASM target as well as `wasm-bindgen` installed to generate these bindings:

```bash
rustup target add wasm32-unknown-unknown
cargo install wasm-bindgen-cli
```

From the root directly you can then use these two commands to export the WASM bindings:

```bash
cargo build -p "papyrus_compiler_wasm" --target wasm32-unknown-unknown --release
wasm-bindgen ./target/wasm32-unknown-unknown/release/papyrus_compiler_wasm.wasm --target web --out-dir ./compiler-explorer/src/wasm
```

### Useful commands

- clippy: `cargo clippy`
- rustfmt: `cargo fmt`
- benchmark: `cargo bench`
- cargo-deny: `cargo deny check`